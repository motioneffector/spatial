<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spatial Features - @motioneffector/spatial</title>
  <link rel="stylesheet" href="../demo-files/demo.css">
  <link rel="stylesheet" href="manual.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', () => hljs.highlightAll());</script>
</head>
<body>
  <div class="page">
    <header class="header">
      <h1 class="header-title">@motioneffector/spatial</h1>
      <p class="header-description">Documentation</p>
      <nav class="header-links">
        <a href="../index.html" class="header-link">Demo</a>
        <a href="https://www.npmjs.com/package/@motioneffector/spatial" class="header-link">npm</a>
        <a href="https://github.com/motioneffector/spatial" class="header-link">GitHub</a>
      </nav>
    </header>

    <div class="manual-layout">
      <aside class="manual-sidebar">
        <nav class="sidebar-nav">
<p><strong><a href="index.html">@motioneffector/spatial</a></strong></p>
<p><strong>Getting Started</strong></p>
<ul>
<li><a href="installation.html">Installation</a></li>
<li><a href="your-first-map.html">Your First Map</a></li>
</ul>
<p><strong>Core Concepts</strong></p>
<ul>
<li><a href="concept-nodes-and-connections.html">Nodes and Connections</a></li>
<li><a href="concept-directions.html">Directions</a></li>
<li><a href="concept-gates.html">Gates</a></li>
<li><a href="concept-traversal-and-pathfinding.html">Traversal and Pathfinding</a></li>
<li><a href="concept-spatial-features.html">Spatial Features</a></li>
</ul>
<p><strong>Guides</strong></p>
<ul>
<li><a href="guide-adding-gates-and-locked-doors.html">Adding Gates and Locked Doors</a></li>
<li><a href="guide-pathfinding.html">Pathfinding</a></li>
<li><a href="guide-working-with-layers.html">Working with Layers</a></li>
<li><a href="guide-custom-directions.html">Custom Directions</a></li>
<li><a href="guide-saving-and-loading-graphs.html">Saving and Loading Graphs</a></li>
<li><a href="guide-reacting-to-graph-changes.html">Reacting to Graph Changes</a></li>
<li><a href="guide-analyzing-graph-structure.html">Analyzing Graph Structure</a></li>
</ul>
<p><strong>API Reference</strong></p>
<ul>
<li><a href="api-graph-creation-and-types.html">Graph Creation and Types</a></li>
<li><a href="api-node-management.html">Node Management</a></li>
<li><a href="api-connection-management.html">Connection Management</a></li>
<li><a href="api-gate-management.html">Gate Management</a></li>
<li><a href="api-pathfinding.html">Pathfinding</a></li>
<li><a href="api-spatial-features.html">Spatial Features</a></li>
<li><a href="api-direction-utilities.html">Direction Utilities</a></li>
<li><a href="api-graph-analysis.html">Graph Analysis</a></li>
<li><a href="api-events.html">Events</a></li>
<li><a href="api-serialization.html">Serialization</a></li>
</ul>

        </nav>
      </aside>

      <main class="manual-content">
        <article class="manual-article">
<h1>Spatial Features</h1>
<p>For grid-based games, nodes can occupy specific tile positions, span multiple cells, and exist on different layers. Zones provide logical grouping across any nodes. These features bridge the abstract graph with visual or spatial representation.</p>
<h2>How It Works</h2>
<p><strong>Multi-tile nodes</strong> occupy grid positions. A large hall might span a 3×2 area. You query &quot;what node is at position (5, 3)?&quot; and get back the node ID. This connects your graph navigation to a visual map.</p>
<p><strong>Layers</strong> stack spaces vertically. Floor 1, floor 2, basement—each is a layer. The same (x, y) coordinate on different layers represents different locations. Layers are independent; same coordinates don&#39;t conflict.</p>
<p><strong>Zones</strong> are logical labels. Tag all rooms in &quot;castle-east-wing&quot; or all shops in &quot;market-district.&quot; Query nodes by zone for game logic, quest tracking, or region-based effects.</p>
<pre><code>Layer 2:  [Attic -----]
          (0,0)  (1,0)

Layer 1:  [Hall] [Kitchen]
          (0,0)   (1,0)

Same coordinates, different layers = different nodes
</code></pre>
<h2>Basic Usage</h2>
<pre><code class="language-typescript">import { createSpatialGraph, Direction } from &#39;@motioneffector/spatial&#39;

const graph = createSpatialGraph()

// Multi-tile node (spans 2 cells)
graph.createNode(&#39;great-hall&#39;, {
  name: &#39;Great Hall&#39;,
  tiles: [{ x: 0, y: 0 }, { x: 1, y: 0 }]
})

// Query by position
const nodeAt = graph.getNodeAt(0, 0)
console.log(nodeAt) // &#39;great-hall&#39;

const alsoHall = graph.getNodeAt(1, 0)
console.log(alsoHall) // &#39;great-hall&#39; (same node, different tile)

// Nodes on different layers
graph.createNode(&#39;basement&#39;, { tiles: [{ x: 0, y: 0 }], layer: 0 })
graph.createNode(&#39;ground-floor&#39;, { tiles: [{ x: 0, y: 0 }], layer: 1 })

// Same coordinates, different layers
console.log(graph.getNodeAt(0, 0, 0)) // &#39;basement&#39;
console.log(graph.getNodeAt(0, 0, 1)) // &#39;ground-floor&#39;

// Zones
graph.setZone(&#39;great-hall&#39;, &#39;castle&#39;)
graph.setZone(&#39;throne-room&#39;, &#39;castle&#39;)
const castleRooms = graph.getNodesInZone(&#39;castle&#39;)
console.log(castleRooms) // [&#39;great-hall&#39;, &#39;throne-room&#39;]
</code></pre>
<h2>Key Points</h2>
<ul>
<li><strong>Layer defaults to 1</strong> — If you don&#39;t specify a layer, nodes are on layer 1. <code>getNodeAt(x, y)</code> searches layer 1 by default.</li>
<li><strong>Multi-tile nodes share the same ID</strong> — All tiles of a multi-tile node return the same node ID. The node is one entity occupying multiple positions.</li>
<li><strong>Zones are independent of layers</strong> — A zone can contain nodes from any layer. They&#39;re logical groups, not spatial ones.</li>
<li><strong><code>getBounds()</code> returns the bounding box</strong> — For multi-tile nodes, get the min/max coordinates to know the node&#39;s extent.</li>
</ul>
<h2>Examples</h2>
<h3>Multi-Tile Rooms</h3>
<p>Model rooms that span multiple grid cells.</p>
<pre><code class="language-typescript">// An L-shaped room
graph.createNode(&#39;l-room&#39;, {
  name: &#39;L-Shaped Chamber&#39;,
  tiles: [
    { x: 0, y: 0 },
    { x: 0, y: 1 },
    { x: 0, y: 2 },
    { x: 1, y: 0 }
  ]
})

// Get all tiles
const tiles = graph.getTiles(&#39;l-room&#39;)
console.log(tiles)
// [{ x: 0, y: 0, layer: 1 }, { x: 0, y: 1, layer: 1 }, ...]

// Get bounding box
const bounds = graph.getBounds(&#39;l-room&#39;)
console.log(bounds)
// { minX: 0, maxX: 1, minY: 0, maxY: 2 }
</code></pre>
<h3>Multi-Floor Buildings</h3>
<p>Connect floors with UP/DOWN directions.</p>
<pre><code class="language-typescript">graph.createNode(&#39;ground&#39;, { layer: 1 })
graph.createNode(&#39;upstairs&#39;, { layer: 2 })
graph.createNode(&#39;basement&#39;, { layer: 0 })

graph.connect(&#39;ground&#39;, Direction.UP, &#39;upstairs&#39;)
graph.connect(&#39;ground&#39;, Direction.DOWN, &#39;basement&#39;)

// Query nodes by layer
const groundFloor = graph.getNodesInLayer(1)
console.log(groundFloor) // [&#39;ground&#39;]
</code></pre>
<h3>Zone-Based Queries</h3>
<p>Group nodes for game logic.</p>
<pre><code class="language-typescript">// Set up zones
graph.setZone(&#39;shop1&#39;, &#39;market&#39;)
graph.setZone(&#39;shop2&#39;, &#39;market&#39;)
graph.setZone(&#39;shop3&#39;, &#39;market&#39;)
graph.setZone(&#39;castle-gate&#39;, &#39;castle&#39;)
graph.setZone(&#39;throne-room&#39;, &#39;castle&#39;)

// Get all market shops
const marketShops = graph.getNodesInZone(&#39;market&#39;)
console.log(marketShops) // [&#39;shop1&#39;, &#39;shop2&#39;, &#39;shop3&#39;]

// Check a node&#39;s zone
const zone = graph.getZone(&#39;throne-room&#39;)
console.log(zone) // &#39;castle&#39;

// Remove from zone
graph.removeZone(&#39;shop1&#39;)
console.log(graph.getZone(&#39;shop1&#39;)) // null
</code></pre>
<h3>Connecting Multi-Tile Nodes at Specific Tiles</h3>
<p>Specify which tiles form the connection point.</p>
<pre><code class="language-typescript">graph.createNode(&#39;hall&#39;, {
  tiles: [{ x: 0, y: 0 }, { x: 1, y: 0 }, { x: 2, y: 0 }]
})
graph.createNode(&#39;kitchen&#39;, {
  tiles: [{ x: 3, y: 0 }]
})

// Connect from the east side of hall to kitchen
graph.connect(&#39;hall&#39;, Direction.EAST, &#39;kitchen&#39;, {
  fromTile: { x: 2, y: 0 },
  toTile: { x: 3, y: 0 }
})

const conn = graph.getConnection(&#39;hall&#39;, Direction.EAST)
console.log(conn?.fromTile) // { x: 2, y: 0 }
console.log(conn?.toTile)   // { x: 3, y: 0 }
</code></pre>
<h2>Related</h2>
<ul>
<li><strong><a href="guide-working-with-layers.html">Working with Layers</a></strong> — Building multi-floor structures</li>
<li><strong><a href="concept-nodes-and-connections.html">Nodes and Connections</a></strong> — Basic node concepts</li>
<li><strong><a href="api-spatial-features.html">Spatial Features API</a></strong> — Full method reference</li>
</ul>

        </article>
      </main>
    </div>
  </div>
</body>
</html>
