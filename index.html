<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@motioneffector/spatial - Demo</title>
  <link rel="stylesheet" href="demo-files/demo.css">
</head>
<body>
  <div class="page">
    <header class="header">
      <h1 class="header-title">@motioneffector/spatial</h1>
      <p class="header-description">Directional graph for room-based spatial navigation</p>
      <nav class="header-links">
        <a href="https://www.npmjs.com/package/@motioneffector/spatial" class="header-link" target="_blank">üì¶ npm</a>
        <a href="https://github.com/motioneffector/spatial" class="header-link" target="_blank">üíª GitHub</a>
        <a href="https://github.com/motioneffector/spatial/wiki" class="header-link" target="_blank">üìñ Manual</a>
      </nav>
    </header>

    <main>
      <!-- Test Runner (FIRST, before all exhibits) -->
      <section class="test-runner" id="test-runner">
        <div class="test-runner-header">
          <h2 class="test-runner-title">Test Runner</h2>
        </div>
        <div class="test-runner-content">
          <!-- Control bar: progress bar + buttons, above output console -->
          <div class="test-control-bar">
            <div class="test-progress">
              <div class="test-progress-bar">
                <div class="test-progress-fill" id="progress-fill"></div>
              </div>
              <div class="test-progress-text" id="progress-text">Ready</div>
            </div>
            <div class="test-runner-actions">
              <button class="btn btn-primary" id="run-all-tests">
                <span class="btn-icon">‚ñ∂</span>
                <span>Run All Tests</span>
              </button>
              <button class="btn btn-secondary" id="reset-page">
                <span class="btn-icon">‚Üª</span>
                <span>Reset Page</span>
              </button>
            </div>
          </div>
          <!-- Output console below the control bar -->
          <div class="test-output" id="test-output">
            <div class="test-output-placeholder">Click "Run All Tests" to execute the test suite and see a live demonstration</div>
          </div>
          <div class="test-summary hidden" id="test-summary"></div>
        </div>
      </section>

      <!-- Exhibit 1: Dungeon Explorer -->
      <section class="exhibit" id="exhibit-dungeon">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Dungeon Explorer</h2>
          <p class="exhibit-description">Navigate through a connected graph with locked doors, keys, and pathfinding. Click rooms to move, collect keys to unlock doors.</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive" id="exhibit-1">
            <div class="dungeon-map" id="dungeon-map"></div>
            <div class="dungeon-controls">
              <div class="compass-rose" id="compass-rose"></div>
              <div class="keyring">
                <div class="keyring-title">Keyring</div>
                <div class="keyring-keys" id="keyring"></div>
              </div>
            </div>
          </div>
          <div class="exhibit-controls">
            <button class="btn btn-secondary" id="dungeon-reset">Reset</button>
            <label class="toggle">
              <input type="checkbox" id="find-path-toggle">
              <span class="toggle-switch"></span>
              <span class="toggle-label">Find Path Mode</span>
            </label>
            <button class="btn btn-secondary" id="reveal-secret">Reveal Secret Passage</button>
          </div>
        </div>
      </section>

      <!-- Exhibit 2: Graph Workshop -->
      <section class="exhibit" id="exhibit-workshop">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Graph Workshop</h2>
          <p class="exhibit-description">Modify, analyze, and build spatial graphs interactively. Click "Analyze" to see orphans and dead-ends, drag the mini-player to test reachability.</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive" id="exhibit-2">
            <div class="workshop-canvas" id="workshop-canvas"></div>
          </div>
          <div class="exhibit-controls">
            <button class="btn btn-primary" id="workshop-add-node">+ Node</button>
            <button class="btn btn-secondary" id="workshop-analyze">üîç Analyze</button>
            <button class="btn btn-secondary" id="workshop-clear-analysis">Clear Analysis</button>
            <select class="input" id="workshop-examples">
              <option value="">Load Example...</option>
              <option value="minimal">Minimal (3 nodes)</option>
              <option value="dungeon">Dungeon</option>
              <option value="multifloor">Multi-floor</option>
              <option value="disconnected">Disconnected</option>
              <option value="empty">Empty</option>
            </select>
            <button class="btn btn-secondary btn-small" id="workshop-delete-mode">üóë Delete Mode</button>
          </div>
        </div>
      </section>

      <!-- Exhibit 3: Pathfinding Theater -->
      <section class="exhibit" id="exhibit-pathfinding">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Pathfinding Theater</h2>
          <p class="exhibit-description">Watch Dijkstra's algorithm find the shortest path step by step. The "obvious" short path has high costs - watch the algorithm find the better route.</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive" id="exhibit-3">
            <div class="pathfinding-graph" id="pathfinding-graph"></div>
            <div class="pf-queue">
              <span class="pf-queue-label">Queue:</span>
              <div class="pf-queue-tokens" id="pf-queue-tokens"></div>
            </div>
          </div>
          <div class="exhibit-controls">
            <button class="btn btn-primary" id="pf-play">‚ñ∂ Play</button>
            <button class="btn btn-secondary" id="pf-step">Step ‚Üí</button>
            <button class="btn btn-secondary" id="pf-reset">Reset</button>
            <div class="speed-slider">
              <span class="text-secondary">Speed:</span>
              <input type="range" id="pf-speed" min="50" max="500" value="200">
            </div>
            <label class="toggle">
              <input type="checkbox" id="pf-has-key">
              <span class="toggle-switch"></span>
              <span class="toggle-label">Has Key</span>
            </label>
            <button class="btn btn-secondary btn-small" id="pf-randomize">Randomize Costs</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Library (from dist) -->
  <script type="module">
    import * as Library from './dist/index.js'
    window.Library = Library
  </script>

  <!-- Demo scripts (order matters) -->
  <script src="demo-files/test-runner.js"></script>
  <script src="demo-files/demo.js"></script>
  <script src="demo-files/tests.js"></script>
</body>
</html>
